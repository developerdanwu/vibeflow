# Frontend Source Code Guide

## Structure

```
src/
├── routes/           # TanStack Router file-based routes
├── components/       # React components
│   ├── ui/          # shadcn/ui primitives (29 components)
│   ├── big-calendar/ # Full calendar feature module
│   ├── layouts/     # Page layout wrappers
│   └── dialogs/     # Global dialog components
├── hooks/           # Custom React hooks
├── lib/             # Utilities and helpers
├── integrations/    # External service setup (TanStack Query)
├── data/            # Static/demo data
├── styles/          # Additional CSS (calendar.css)
└── test/            # Test setup
```

## Key Patterns

### Routing
- File-based routing via TanStack Router
- **Root:** `__root.tsx`, `_authenticated.tsx`, `index.tsx`, `callback.tsx` (app-wide layout and top-level routes)
- **Feature folders** under `_authenticated/`: one folder per feature (e.g. `calendar/`, `settings/`) with route files by type (layout, index, child routes). Mirrors Convex folder structure (root + feature folders with procedures by type).
- Add new routes for a feature in the appropriate file under that feature's folder.

### Components
- **UI primitives** (`components/ui/`): shadcn/ui components, use `pnpm dlx shadcn@latest add [name]` to add new ones (see root AGENTS.md for shadcn overwrite/install rules)
- **Feature modules** (`components/big-calendar/`): Self-contained with own contexts, hooks, stores, and types
- **Layouts**: Wrap routes with consistent structure
- **No `"use client"`**: You do not need `"use client"` at the top of components; the app uses TanStack Router (not Next.js), so all components are client-rendered by default.

### State Management
- **Server state**: TanStack Query + Convex
- **Client state**: XState Store (`big-calendar/store/calendarStore.ts`)
- **Context**: React Context for component trees (`big-calendar/contexts/`)

### Styling
- Tailwind CSS v4
- Use `cn()` from `lib/utils.ts` for conditional classes
- Component variants via `class-variance-authority`

## Do Not Edit

- `styles.css` - Generated by Tailwind
- `routeTree.gen.ts` - Generated by TanStack Router (see root AGENTS.md for full list of generated files)

## Adding New Code

| Type | Location | Convention |
|------|----------|------------|
| Page | `routes/` | `kebab-case.tsx` |
| Component | `components/` | `PascalCase.tsx` |
| Hook | `hooks/` | `use-kebab-case.ts` |
| Utility | `lib/` | `camelCase.ts` |

## Calendar Module

The `big-calendar/` module is the main feature. Key files:

- `types.ts` - Core types (`TCalendarView`, `TEventColor`, etc.)
- `interfaces.ts` - Event and calendar interfaces
- `schemas.ts` - Zod validation schemas
- `contexts/calendar-context.tsx` - Calendar state provider
- `store/calendarStore.ts` - XState store for UI state
- `hooks/` - `use-add-event`, `use-create-event-mutation`, `use-update-event-mutation`, `use-delete-event-mutation`, `use-drag-to-create`

### Views
- `month-view/` - Month grid with day cells and event badges
- `week-and-day-view/` - Time-based views with event blocks
- `year-view/` - Year overview
- `agenda-view/` - List-style event view

### Features
- `dnd/` - Drag and drop (@dnd-kit/core)
- `dialogs/` - Add/edit/details event dialogs
- `header/` - Navigation and view controls

### Related Documentation
- **Drag and Drop:** See [src/docs/dnd-handling.md](src/docs/dnd-handling.md) for locked event handling and drag prevention patterns
